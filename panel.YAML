# ===================================================================
#      PANEL CONFIG PARA TOPOLOGIA DE REDE - 5F
# ===================================================================
# Instruções:
# 1. Copie e cole este código no campo "Panel Config" do Grafana.
# 2. Na aba "Query", crie uma consulta para cada "metricName" abaixo.
# 3. O "Alias" da sua query DEVE SER IGUAL ao "metricName".
# ===================================================================

# -------------------------------------------------------------------
# Seção 1: REGRAS DE CORES (THRESHOLDS)
# -------------------------------------------------------------------
thresholds:
  # Regra para status geral (0=OK, 1=Problema/Alerta)
  - name: 'status_geral'
    levels:
      - value: 0
        color: 'green'
      - value: 1
        color: 'red'

  # Regra para tráfego de rede em bits/s
  - name: 'nivel_trafego'
    levels:
      - value: 0           # 0 bps
        color: 'green'
      - value: 500000000   # 500 Mbps
        color: 'orange'
      - value: 800000000   # 800 Mbps
        color: 'red'

  # Regra para uso de CPU em %
  - name: 'nivel_cpu'
    levels:
      - value: 0
        color: 'green'
      - value: 80
        color: 'orange'
      - value: 95
        color: 'red'

  # Regra para temperatura em Celsius
  - name: 'nivel_temperatura'
    levels:
      - value: 0
        color: 'blue'
      - value: 25
        color: 'orange'
      - value: 30
        color: 'red'

# -------------------------------------------------------------------
# Seção 2: MAPEAMENTOS (MAPPINGS)
# Conectando os dados aos elementos do seu desenho.
# -------------------------------------------------------------------
mappings:
  # --- CLOUDS ---
  - { metricName: 'ping_azure',         cellId: 'AZURECLOUD',       type: 'fillColor', thresholdName: 'status_geral' }
  - { metricName: 'ping_aws',           cellId: 'AWSCLOUD',         type: 'fillColor', thresholdName: 'status_geral' }
  - { metricName: 'ping_zadara',        cellId: 'ZADARACLOUD',      type: 'fillColor', thresholdName: 'status_geral' }
  - { metricName: 'ping_google',        cellId: 'GOOGLECLOUD',      type: 'fillColor', thresholdName: 'status_geral' }
  - { metricName: 'ping_zoho',          cellId: 'ZOHOCLOUD',        type: 'fillColor', thresholdName: 'status_geral' }
  - { metricName: 'ping_watchguard',    cellId: 'WATCHGAURDCLOUD',  type: 'fillColor', thresholdName: 'status_geral' }

  # --- PROVEDORES DE INTERNET (ISPs) ---
  - { metricName: 'latencia_vivo',      cellId: 'ISP01VIVO',        type: 'fillColor', thresholdName: 'status_geral' }
  - { metricName: 'latencia_embratel',  cellId: 'ISP02EMBRATEL',    type: 'fillColor', thresholdName: 'status_geral' }

  # --- ROTEADORES DE BORDA ---
  - { metricName: 'trafego_vivo',       cellId: 'VIVO',             type: 'label',     label: { text: '${value:fmt(bits/s)}' } }
  - { metricName: 'trafego_embratel',   cellId: 'EMBRATEL',         type: 'label',     label: { text: '${value:fmt(bits/s)}' } }

  # --- FIREWALL (Exemplo com múltiplos mapeamentos) ---
  - metricName: 'ping_firewall'
    cellId: 'FirewallWatchgaurd'
    type: 'strokeColor'  # Muda a cor da borda com base no status do ping
    thresholdName: 'status_geral'
  - metricName: 'trafego_in_firewall'
    cellId: 'FirewallWatchgaurd'
    type: 'label'
    label:
      text: 'In: ${value:fmt(bits/s)}' # Exibe o tráfego de entrada
      yOffset: -15 # Ajusta a posição do texto para cima
  - metricName: 'trafego_out_firewall'
    cellId: 'FirewallWatchgaurd'
    type: 'label'
    label:
      text: 'Out: ${value:fmt(bits/s)}' # Exibe o tráfego de saída
      yOffset: 15 # Ajusta a posição do texto para baixo

  # --- SWITCHES ---
  - { metricName: 'ping_sw_dmz',        cellId: 'SWITCHDMZ',        type: 'fillColor', thresholdName: 'status_geral' }
  - { metricName: 'ping_sw_core',       cellId: 'SWCORE',           type: 'fillColor', thresholdName: 'status_geral' }
  - { metricName: 'cpu_sw_core',        cellId: 'SWCORE',           type: 'label',     label: { text: 'CPU: ${value:fmt(percent)}' } }
  - { metricName: 'ping_sw_2960',       cellId: 'SW2960',           type: 'fillColor', thresholdName: 'status_geral' }

  # --- SERVIDORES E DISPOSITIVOS NA DMZ ---
  - { metricName: 'ping_backend_pg',    cellId: 'BackendPostgre',   type: 'fillColor', thresholdName: 'status_geral' }
  - { metricName: 'ping_dimension',     cellId: 'dimension',        type: 'fillColor', thresholdName: 'status_geral' }
  - { metricName: 'cpu_dimension',      cellId: 'dimension',        type: 'label',     label: { text: '${value:fmt(percent)}' } }
  
  # --- SERVIDORES INTERNOS E OUTROS DISPOSITIVOS ---
  - { metricName: 'temp_rack',          cellId: 'TermometroIP',     type: 'label',     label: { text: '${value:fmt(temperature)}' } }
  - { metricName: 'temp_rack',          cellId: 'TermometroIP',     type: 'fillColor', thresholdName: 'nivel_temperatura' }
  - { metricName: 'status_servico_postgres', cellId: 'BackendPostgre2', type: 'fillColor', thresholdName: 'status_geral' }
  - { metricName: 'ping_cfs01',         cellId: 'CFS01',            type: 'fillColor', thresholdName: 'status_geral' }
  - { metricName: 'ping_cfs02',         cellId: 'CFS02',            type: 'fillColor', thresholdName: 'status_geral' }
